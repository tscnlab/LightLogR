<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Import &amp; cleaning • LightLogR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import &amp; cleaning">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LightLogR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Day.html">The whole game</a></li>
    <li><a class="dropdown-item" href="../articles/Import.html">Import &amp; cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/Metrics.html">Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/photoperiod.html">Photoperiod</a></li>
    <li><a class="dropdown-item" href="../articles/Visualizations.html">Visualizations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tscnlab/LightLogR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import &amp; cleaning</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tscnlab/LightLogR/blob/main/vignettes/articles/Import.Rmd" class="external-link"><code>vignettes/articles/Import.Rmd</code></a></small>
      <div class="d-none name"><code>Import.Rmd</code></div>
    </div>

    
    
<p>This article focuses on the import from multiple files and
participants, as well as the cleaning of the data. We need these
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tscnlab/LightLogR" class="external-link">LightLogR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yutannihilation.github.io/gghighlight/" class="external-link">gghighlight</a></span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Please note that this article uses the base pipe operator
<code>|&gt;</code>. You need an R version equal to or greater than 4.1.0
to use it. If you are using an older version, you can replace it with
the <code>magrittr</code> pipe operator <code>%&gt;%</code>.</p>
</blockquote>
<div class="section level2">
<h2 id="from-which-devices-can-i-import-data">From which devices can I import data?<a class="anchor" aria-label="anchor" href="#from-which-devices-can-i-import-data"></a>
</h2>
<p>LightLogR aims to provide standard import routines for all devices
used in research on personal light exposure. Currently, the following
devices are supported:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/supported_devices.html">supported_devices</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Actiwatch_Spectrum"    "Actiwatch_Spectrum_de" "ActLumus"             </span></span>
<span><span class="co">#&gt;  [4] "ActTrust"              "Circadian_Eye"         "DeLux"                </span></span>
<span><span class="co">#&gt;  [7] "GENEActiv_GGIR"        "Kronowise"             "LiDo"                 </span></span>
<span><span class="co">#&gt; [10] "LightWatcher"          "LIMO"                  "LYS"                  </span></span>
<span><span class="co">#&gt; [13] "MotionWatch8"          "nanoLambda"            "OcuWEAR"              </span></span>
<span><span class="co">#&gt; [16] "Speccy"                "SpectraWear"           "VEET"</span></span></code></pre></div>
<p>More Information on these devices can be found in the reference for
<code><a href="../reference/import_Dataset.html">import_Dataset()</a></code>.</p>
<div class="section level3">
<h3 id="what-if-my-device-is-not-listed">What if my device is not listed?<a class="anchor" aria-label="anchor" href="#what-if-my-device-is-not-listed"></a>
</h3>
<p>If you are using a device that is currently not supported, please
contact the developers. We are always looking to expand the range of
supported devices. The easiest and most trackable way to get in contact
is by opening a new issue on our <a href="https://github.com/tscnlab/LightLogR/issues" class="external-link">Github
repository</a>. Please see the <a href="https://tscnlab.github.io/LightLogR/CONTRIBUTING.html">CONTRIBUTING</a>
section for different ways to help and details about how this project
handles them.</p>
</div>
<div class="section level3">
<h3 id="what-if-my-device-is-listed-but-the-import-does-not-work-as-expected">What if my device is listed but the import does not work as
expected?<a class="anchor" aria-label="anchor" href="#what-if-my-device-is-listed-but-the-import-does-not-work-as-expected"></a>
</h3>
<p>We regularly find that files exported from the same device model can
differ in structure. This may be due to different settings, software or
hardware updates. If you encounter problems with the import, please get
in contact with us, e.g. by opening an issue on our <a href="https://github.com/tscnlab/LightLogR/issues" class="external-link">Github
repository</a>. Please see the <a href="https://tscnlab.github.io/LightLogR/CONTRIBUTING.html">CONTRIBUTING</a>
section for different ways to help and details about how this project
handles them.</p>
</div>
<div class="section level3">
<h3 id="are-there-other-ways-to-import-data">Are there other ways to import data?<a class="anchor" aria-label="anchor" href="#are-there-other-ways-to-import-data"></a>
</h3>
<p>Yes. <code>LightLogR</code> simply requires a <code>data.frame</code>
with a column containing <code>datetime</code> formatted data. Even a
<code>light</code> data column is not strictly necessary, as
<code>LightLogR</code> is optimized for, but not restricted to, light
data. Further, an <code>Id</code> column is used in some functions to
distinguish between different participants.</p>
<p>To make life easier when using functions in <code>LightLogR</code>,
the datetime column should be named <code>Datetime</code>, the id column
<code>Id</code>, and, if present, the melanopic EDI light information
<code>MEDI</code>.</p>
<p>Lastly, you can modify or add import functions that build upon
<code>LightLogR</code>s import functionality. See the last chapter in
this article for more information on that.</p>
</div>
</div>
<div class="section level2">
<h2 id="importing-data">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<p>The first step in every analysis is data import. We will work with
data collected as part of the Master Thesis <em>Insights into real-world
human light exposure: relating self-report with eye-level light
logging</em> by Carolina Guidolin (2023). The data is stored in 17 text
files in the <em>data/</em> folder. You can access the data yourself
through the <a href="https://github.com/tscnlab/LightLogR/tree/main/vignettes/articles/data" class="external-link">LightLogR
GitHub repository</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#this assumes that you downloaded the files into a folder called "data" in the working directory</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">path</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#show how many files are listes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 17</span></span></code></pre></div>
<p>Next we require a time zone of data collection. If uncertain which
time zones are valid, use the <code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames()</a></code> function. Our
data was collected in the “Europe/Berlin” time zone.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#first six time zones from OlsonNames()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Africa/Abidjan"     "Africa/Accra"       "Africa/Addis_Ababa"</span></span>
<span><span class="co">#&gt; [4] "Africa/Algiers"     "Africa/Asmara"      "Africa/Asmera"</span></span>
<span></span>
<span><span class="co">#our time zone</span></span>
<span><span class="va">tz</span> <span class="op">&lt;-</span> <span class="st">"Europe/Berlin"</span></span></code></pre></div>
<p>Lastly, the participant Ids are stored in the file names. We will
extract them and store them in a column called <code>Id</code>. The
following code defines the pattern as a <em>regular expression</em>,
which will extract the first three digits from the file name.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="st">"^(\\d{3})"</span></span></code></pre></div>
<p>Now we can import the data. Data were collected with the ActLumus
device by Condor Instruments. The right way to specify this is through
the <code>import</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span><span class="op">$</span><span class="fu">ActLumus</span><span class="op">(</span><span class="va">files</span>, tz <span class="op">=</span> <span class="va">tz</span>, auto.id <span class="op">=</span> <span class="va">pattern</span>, print_n<span class="op">=</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Successfully read in 1'034'650 observations across 17 Ids from 17 ActLumus-file(s).</span></span>
<span><span class="co">#&gt; Timezone set is Europe/Berlin.</span></span>
<span><span class="co">#&gt; The system timezone is UTC. Please correct if necessary!</span></span>
<span><span class="co">#&gt; Observations in the following 2 file(s) cross to or from daylight savings time (DST): </span></span>
<span><span class="co">#&gt; 221_actlumus_Log_1607_20231030121531432</span></span>
<span><span class="co">#&gt; 222_actlumus_Log_1020_20231030140039534</span></span>
<span><span class="co">#&gt; Please make sure that the timestamps in the source files correctly reflect these changes from DST&lt;&gt;ST. </span></span>
<span><span class="co">#&gt; To adjust datetimes after a jump, set `dst_adjustment = TRUE` or see `?dst_change_handler` for manual adjustment.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; First Observation: 2023-08-14 10:55:21</span></span>
<span><span class="co">#&gt; Last Observation: 2023-10-30 15:00:32</span></span>
<span><span class="co">#&gt; Timespan: 77 days</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observation intervals: </span></span>
<span><span class="co">#&gt;    Id    interval.time              n pct  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 201   10s                    <span style="text-decoration: underline;">60</span>042 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 202   10s                    <span style="text-decoration: underline;">59</span>957 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 204   10s                    <span style="text-decoration: underline;">61</span>980 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 205   10s                    <span style="text-decoration: underline;">61</span>015 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 206   10s                    <span style="text-decoration: underline;">60</span>691 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 206   23s                        1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 206   59575s (~16.55 hours)      1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 208   10s                    <span style="text-decoration: underline;">59</span>853 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 209   10s                    <span style="text-decoration: underline;">60</span>084 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 210   10s                    <span style="text-decoration: underline;">60</span>701 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 212   10s                    <span style="text-decoration: underline;">59</span>478 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 213   10s                    <span style="text-decoration: underline;">59</span>720 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 214   10s                    <span style="text-decoration: underline;">61</span>836 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 214   16s                        1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 214   1197207s (~1.98 weeks)     1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 215   7s                         1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 215   10s                    <span style="text-decoration: underline;">60</span>707 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 216   10s                    <span style="text-decoration: underline;">61</span>760 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 216   19s                        1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 216   240718s (~2.79 days)       1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span> 218   8s                         1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span> 218   10s                    <span style="text-decoration: underline;">60</span>929 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span> 218   11s                        1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span> 219   9s                         1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span> 219   10s                    <span style="text-decoration: underline;">61</span>634 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">26</span> 219   16s                        1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">27</span> 219   583386s (~6.75 days)       1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">28</span> 221   9s                         1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">29</span> 221   10s                    <span style="text-decoration: underline;">62</span>340 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">30</span> 221   19s                        1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">31</span> 221   3610s (~1 hours)           1 0%   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">32</span> 222   10s                    <span style="text-decoration: underline;">61</span>890 100% </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">33</span> 222   3610s (~1 hours)           1 0%</span></span></code></pre></div>
<p><img src="Import_files/figure-html/import-1.png" width="700"></p>
<div class="section level3">
<h3 id="my-import-is-slow--why-is-that-and-can-i-speed-it-up">My import is slow. Why is that and can I speed it up?<a class="anchor" aria-label="anchor" href="#my-import-is-slow--why-is-that-and-can-i-speed-it-up"></a>
</h3>
<p>There are several possibilities, why the import is slow. The most
common reasons are:</p>
<ul>
<li><p>The data files are simply large. With short measurement
intervals, many participants, and long measurement periods, files for a
single study can easily reach several gigabytes. This takes some time to
import and is ok.</p></li>
<li><p>The data files contain many gaps. During import,
<code>LightLogR</code> checks for and visualizes gaps in the data.
Especially large datasets with small intervals contain many gaps, which
can slow down the import process.</p></li>
<li><p>The device model you are importing from has non-consistent data
structures. Some devices have a varying number of rows before the actual
data starts. This means a small portion of every file has to be read in
and the correct starting row has to be found. This can slow down the
import process if you have many files.</p></li>
</ul>
<p>If you are experiencing slow imports, you can try the following:</p>
<ul>
<li><p>Only read in part of your datasets, or split your dataset into
several pieces, that each gets loaded in separately. You can combine
them afterwards with <code><a href="../reference/join_datasets.html">join_datasets()</a></code>.</p></li>
<li><p>If you have many gaps in your data, you can set
<code>auto.plot = FALSE</code> in the import function. This will
eliminate the call to <code><a href="../reference/gg_overview.html">gg_overview()</a></code>, which calculates and
visualizes the gaps in the data.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="data-cleaning-1">Data cleaning #1<a class="anchor" aria-label="anchor" href="#data-cleaning-1"></a>
</h2>
<p>Before we can dive into the analysis part, we need to make sure we
have a clean dataset. The import summary shows us two problems with the
data:</p>
<ul>
<li><p>two files have data that crosses daylight saving time (DST)
changes. Because the ActLumus device does not adjust for DST, we need to
correct for this.</p></li>
<li><p>Multiple Ids have single datapoints at the beginning of the
dataset with gaps before actual data collection starts. These are test
measurements to check equipment, but must be removed from the
dataset.</p></li>
</ul>
<p>Let us first deal with the DST change. LightLogR has an in-built
function to correct for this during import. We thus will re-import the
data, but make the import silent as to not clutter the output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">import</span><span class="op">$</span><span class="fu">ActLumus</span><span class="op">(</span><span class="va">files</span>, tz <span class="op">=</span> <span class="va">tz</span>, auto.id <span class="op">=</span> <span class="va">pattern</span>, dst_adjustment <span class="op">=</span> <span class="cn">TRUE</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The second problem requires the filtering of certain Ids. The
<code><a href="../reference/filter_Datetime_multiple.html">filter_Datetime_multiple()</a></code> function is ideal for this. We
can provide a length (1 week), starting from the end of data collection
and backwards. The variable <code>arguments</code> provide variable
arguments to the filter function, they have to be provided in list form
and expressions have to be quoted through<code><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote()</a></code>. Fixed
arguments, like the length and<code>length_from_start\</code> are
provided as named arguments and only have to be specified once, as they
are the same for all Ids.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/filter_Datetime_multiple.html">filter_Datetime_multiple</a></span><span class="op">(</span></span>
<span>    arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">216</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">219</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">214</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">206</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>, </span>
<span>    length <span class="op">=</span> <span class="st">"1 week"</span>, length_from_start <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Let’s have a look at the data again with the
<code><a href="../reference/gg_overview.html">gg_overview()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/gg_overview.html">gg_overview</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Import_files/figure-html/overview-1.png" width="700"></p>
<p>Looks much better now. Also, because there is no longer a hint about
gaps in the lower right corner, we can be sure that all gaps have been
removed. The function gap_finder() shows us, however, that there are
still irregularities in the data and the function count_difftime()
reveals where they are.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gap_finder.html">gap_finder</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Found 183580 gaps. 847054 Datetimes fall into the regular sequence.</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/count_difftime.html">count_difftime</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">22</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 22 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Id [17]</span></span></span>
<span><span class="co">#&gt;    Id    difftime       n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;Duration&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 221   10s        <span style="text-decoration: underline;">62</span>341</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 204   10s        <span style="text-decoration: underline;">61</span>980</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 222   10s        <span style="text-decoration: underline;">61</span>891</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 205   10s        <span style="text-decoration: underline;">61</span>015</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 218   10s        <span style="text-decoration: underline;">60</span>929</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 215   10s        <span style="text-decoration: underline;">60</span>707</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 210   10s        <span style="text-decoration: underline;">60</span>701</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 206   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 214   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 216   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 219   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 209   10s        <span style="text-decoration: underline;">60</span>084</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 201   10s        <span style="text-decoration: underline;">60</span>042</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 202   10s        <span style="text-decoration: underline;">59</span>957</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 208   10s        <span style="text-decoration: underline;">59</span>853</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 213   10s        <span style="text-decoration: underline;">59</span>720</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 212   10s        <span style="text-decoration: underline;">59</span>478</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 215   7s             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 218   8s             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 218   11s            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span> 221   9s             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span> 221   19s            1</span></span></code></pre></div>
<p>This means we have to look at and take care of the irregularities for
the Ids 215, 218, and 221.</p>
</div>
<div class="section level2">
<h2 id="data-cleaning-2">Data cleaning #2<a class="anchor" aria-label="anchor" href="#data-cleaning-2"></a>
</h2>
<p>Let us first visualize where the irregularities are. We can use
<code><a href="../reference/gg_days.html">gg_days()</a></code> for that.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create two columns to show the irregularities and gaps for relevant ids</span></span>
<span><span class="va">difftimes</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">215</span>, <span class="fl">218</span>, <span class="fl">221</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difftime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">Datetime</span><span class="op">)</span>, <span class="va">Datetime</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span>,</span>
<span>                  end <span class="op">=</span> <span class="va">Datetime</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">seconds</a></span><span class="op">(</span><span class="va">difftime</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualize where those points are</span></span>
<span><span class="va">difftimes</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gg_days.html">gg_days</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>          x.axis.breaks <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="../reference/Datetime_breaks.html">Datetime_breaks</a></span><span class="op">(</span><span class="va">.x</span>, by <span class="op">=</span> <span class="st">"2 days"</span> <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">difftimes</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">difftime</span> <span class="op">!=</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">Datetime</span>, xmax <span class="op">=</span> <span class="va">end</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>            fill <span class="op">=</span> <span class="st">"red"</span>, col <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://yutannihilation.github.io/gghighlight/reference/gghighlight.html" class="external-link">gghighlight</a></span><span class="op">(</span><span class="va">difftime</span> <span class="op">!=</span> <span class="fl">10</span> <span class="op">|</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">difftime</span> <span class="op">!=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Import_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>All irregular data appear at the very beginning of the data
collection. As we are interestet in one whole week of data, we can
similarly apply a one week filter on these Ids and see if that removed
the irregular data points.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/filter_Datetime_multiple.html">filter_Datetime_multiple</a></span><span class="op">(</span></span>
<span>    arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">215</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">218</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>only_Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">Id</span> <span class="op">==</span> <span class="fl">221</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>, length <span class="op">=</span> <span class="st">"1 week"</span>, length_from_start <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/gap_finder.html">gap_finder</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; No gaps found</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/count_difftime.html">count_difftime</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">17</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 17 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   Id [17]</span></span></span>
<span><span class="co">#&gt;    Id    difftime       n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;Duration&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 204   10s        <span style="text-decoration: underline;">61</span>980</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 222   10s        <span style="text-decoration: underline;">61</span>891</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 205   10s        <span style="text-decoration: underline;">61</span>015</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 221   10s        <span style="text-decoration: underline;">60</span>839</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 210   10s        <span style="text-decoration: underline;">60</span>701</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 206   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 214   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 215   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 216   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 218   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 219   10s        <span style="text-decoration: underline;">60</span>479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 209   10s        <span style="text-decoration: underline;">60</span>084</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 201   10s        <span style="text-decoration: underline;">60</span>042</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 202   10s        <span style="text-decoration: underline;">59</span>957</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 208   10s        <span style="text-decoration: underline;">59</span>853</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 213   10s        <span style="text-decoration: underline;">59</span>720</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 212   10s        <span style="text-decoration: underline;">59</span>478</span></span></code></pre></div>
<p>The data is now clean and we can proceed with the analysis. This
dataset will be needed in other articles, so we will save it as an RDS
file.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#uncomment next lines to save the data</span></span>
<span><span class="co"># if (!dir.exists("cleaned_data")) dir.create("cleaned_data")</span></span>
<span><span class="co"># saveRDS(data, "cleaned_data/ll_data.rds")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-data-miscellaneous">Importing data: Miscellaneous<a class="anchor" aria-label="anchor" href="#importing-data-miscellaneous"></a>
</h2>
<div class="section level3">
<h3 id="other-import-arguments">Other import arguments<a class="anchor" aria-label="anchor" href="#other-import-arguments"></a>
</h3>
<p>Other potentially important arguments are the <code>locale</code>
argument - this is useful if you have special characters in your data
(e.g. German ü or ä) that are not recognized by the default locale. Look
at <code><a href="https://readr.tidyverse.org/reference/locale.html" class="external-link">readr::default_locale()</a></code> for more information.</p>
<p>The <code>...</code> argument is passed through to whichever import
function is used for the data. For some devices, it is also used to
provide additional information, such as <code>column_names</code> for
the Actiwatch devices, that differ depending on the language setting of
the device and software. Whether a device requires additional
information can be found in the import documentation (see
<code><a href="../reference/import_Dataset.html">import_Dataset()</a></code>).</p>
</div>
<div class="section level3">
<h3 id="other-ways-to-call-import">Other ways to call import<a class="anchor" aria-label="anchor" href="#other-ways-to-call-import"></a>
</h3>
<p>Instead of using the import function as described above
(<code>import$device()</code>), you can also use the function
<code><a href="../reference/import_Dataset.html">import_Dataset()</a></code> and specify the device as a character
string in the first argument. This might be useful if you want to import
data programmatically from different devices, e.g., through a
<code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code> function. Only
<code><a href="../reference/supported_devices.html">supported_devices()</a></code> will be accepted by the function.</p>
<p>Here is an example:</p>
<pre><code><span><span class="va">devices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ActLumus"</span>, <span class="st">"Speccy"</span><span class="op">)</span></span>
<span><span class="va">files_AL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"path/to/ActLumus/file1.csv"</span>, <span class="st">"path/to/ActLumus/file2.csv"</span><span class="op">)</span></span>
<span><span class="va">files_Sy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"path/to/Speccy/file1.csv"</span>, <span class="st">"path/to/Speccy/file2.csv"</span><span class="op">)</span></span>
<span><span class="va">tz</span> <span class="op">&lt;-</span> <span class="st">"Europe/Berlin"</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">devices</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">files_AL</span>, <span class="va">files_Sy</span><span class="op">)</span>, <span class="va">import_Dataset</span>, tz <span class="op">=</span> <span class="va">tz</span><span class="op">)</span></span></code></pre>
<p>This way, you will end with a list of two dataframes, one with the
ActLumus data and one with the Speccy data.</p>
</div>
<div class="section level3">
<h3 id="creating-your-own-import-function">Creating your own import function<a class="anchor" aria-label="anchor" href="#creating-your-own-import-function"></a>
</h3>
<p><strong>Note: This section is for advanced users only. You should be
familiar with expressions in R and how to manipulate them.</strong></p>
<p><code>LightLogR</code> comes with a number of custom import routines
for different devices, that are then implemented into the main import
function, which covers some general aspects and also creates the summary
overview.</p>
<p>If you would like to write your own custom import function,
<code>LightLogR</code> has you covered. First, you can see what makes
all the import functions tick by looking at the included data set
<code><a href="../reference/ll_import_expr.html">ll_import_expr()</a></code>. This is a list of all the individual
routines. Let’s have a look at the ActLumus routine</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ll_import_expr.html">ll_import_expr</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">ActLumus</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     data &lt;- suppressMessages(readr::read_delim(filename, skip = 32, </span></span>
<span><span class="co">#&gt;         delim = ";", n_max = n_max, col_types = paste0("c", paste0(rep("d", </span></span>
<span><span class="co">#&gt;             32), collapse = "")), id = "file.name", locale = locale, </span></span>
<span><span class="co">#&gt;         name_repair = "universal", ...))</span></span>
<span><span class="co">#&gt;     data &lt;- data %&gt;% dplyr::rename(Datetime = DATE.TIME, MEDI = MELANOPIC.EDI) %&gt;% </span></span>
<span><span class="co">#&gt;         dplyr::mutate(Datetime = Datetime %&gt;% lubridate::dmy_hms(tz = tz))</span></span>
<span><span class="co">#&gt; }</span></span></code></pre></div>
<p>We can see, it is rather simple, just a few lines of code. You can
write your own expression and create an import function with it. The
expression should create a <code>data</code> variable that contains the
import script for the files. At the end of the expression, the
<code>data</code> variable should contain the imported dataset and
include a correctly formatted <code>Datetime</code> column, complete
with the correct timezone.</p>
<p>Here we will create a variation of the old routine, that just adds a
short message:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_import_expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ll_import_expr.html">ll_import_expr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">new_import_expr</span><span class="op">$</span><span class="va">ActLumus_new</span> <span class="op">&lt;-</span> <span class="va">new_import_expr</span><span class="op">$</span><span class="va">ActLumus</span></span>
<span><span class="va">new_import_expr</span><span class="op">$</span><span class="va">ActLumus_new</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"**Congratulation, you made a new import function**\n"</span><span class="op">)</span></span>
<span>  <span class="va">data</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="va">new_import_expr</span><span class="op">$</span><span class="va">ActLumus_new</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     data &lt;- suppressMessages(readr::read_delim(filename, skip = 32, </span></span>
<span><span class="co">#&gt;         delim = ";", n_max = n_max, col_types = paste0("c", paste0(rep("d", </span></span>
<span><span class="co">#&gt;             32), collapse = "")), id = "file.name", locale = locale, </span></span>
<span><span class="co">#&gt;         name_repair = "universal", ...))</span></span>
<span><span class="co">#&gt;     data &lt;- data %&gt;% dplyr::rename(Datetime = DATE.TIME, MEDI = MELANOPIC.EDI) %&gt;% </span></span>
<span><span class="co">#&gt;         dplyr::mutate(Datetime = Datetime %&gt;% lubridate::dmy_hms(tz = tz))</span></span>
<span><span class="co">#&gt;     {</span></span>
<span><span class="co">#&gt;         cat("**Congratulation, you made a new import function**\n")</span></span>
<span><span class="co">#&gt;         data</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt; }</span></span></code></pre></div>
<p>We can now create a new import function with this expression. The
function will be called <code>import$ActLumus_new()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">import</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_adjustment.html">import_adjustment</a></span><span class="op">(</span><span class="va">new_import_expr</span><span class="op">)</span></span></code></pre></div>
<p>Let us now import a file of the previous dataset, setting the main
summary and plotting function silent</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span><span class="op">$</span><span class="fu">ActLumus_new</span><span class="op">(</span><span class="va">files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, tz <span class="op">=</span> <span class="va">tz</span>, auto.id <span class="op">=</span> <span class="va">pattern</span>, </span>
<span>                         auto.plot <span class="op">=</span> <span class="cn">FALSE</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; **Congratulation, you made a new import function**</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Zauner, Manuel Spitschan, Steffen Hartmeyer, MeLiDos, EURAMET, European Union.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
