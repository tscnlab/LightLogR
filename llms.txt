# LightLogR

Personalized luminous exposure data is progressively gaining importance
in various sectors, including research, occupational affairs, and
fitness tracking. Data are collected through a proliferating selection
of wearable loggers and dosimeters, varying in size, shape,
functionality, and output format. Despite or maybe because of numerous
use cases, the field lacks a unified framework for collecting,
validating, and analyzing the accumulated data. This issue increases the
time and expertise necessary to handle such data and also compromises
the FAIRness (Findability, Accessibility, Interoperability, Reusability)
of the results, especially in meta-analyses.

![Light logger data can powerfully convey insights into personal light
exposure](reference/figures/Day.png)

Light logger data can powerfully convey insights into personal light
exposure

**LightLogR** is a package under development as part of the
[*MeLiDos*](https://www.melidos.eu) project to address these issues. The
package aims to provide tools for:

- Import from common measurement devices (see below for a list of
  [Supported devices](#supported-devices))

- Cleaning and processing of light logging data

- Visualization of light exposure data, both exploratory and publication
  ready

- Calculation of common analysis parameters (see below for a list of
  [Metrics](#metrics))

To come:

- Import, creation, and verification of crucial metadata

- Semi-automated analysis and visualization (both command-line and
  GUI-based)

- Integration of data into a unified database for cross-study analyses

##### Please note that LightLogR is work in progress! If you are interested in the project and want to know more, you can subscribe to the [LightLogR mailing list](https://www.tscnlab.org/software). If you find a bug or would like to see new or improved features, please open an issue on the [GitHub repository](https://github.com/tscnlab/LightLogR/issues).

Have a look at the [Example](#example) section down below to get
started, or dive into the
[Articles](https://tscnlab.github.io/LightLogR/articles/index.html) to
get more in depth information about how to work with the package and
generate images such as the one above, import data, visualization, and
metric calculation.

## Installation

You can install LightLogR from
[CRAN](https://cran.r-project.org/package=LightLogR) with:

``` r
install.packages("LightLogR")
```

You can install the latest development version of LightLogR from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("tscnlab/LightLogR")
```

## Example

Here is a quick starter on how to use **LightLogR**.

``` r
library(LightLogR)
#the following packages are needed for the examples as shown below.
library(flextable)
library(dplyr)
library(ggplot2)
```

### Import

You can import a light logger dataset with ease. The import functions
give quick, helpful feedback about the dataset.

``` r
filename <- 
  system.file("extdata/205_actlumus_Log_1020_20230904101707532.txt.zip", 
              package = "LightLogR")
dataset <- import$ActLumus(filename, "Europe/Berlin", manual.id = "P1")
#> Multiple files in zip: reading '205_actlumus_Log_1020_20230904101707532.txt'
#> 
#> Successfully read in 61'016 observations across 1 Ids from 1 ActLumus-file(s).
#> Timezone set is Europe/Berlin.
#> 
#> First Observation: 2023-08-28 08:47:54
#> Last Observation: 2023-09-04 10:17:04
#> Timespan: 7.1 days
#> 
#> Observation intervals: 
#>   Id    interval.time     n pct  
#> 1 P1    10s           61015 100%
```

![](reference/figures/README-unnamed-chunk-3-1.png)

For more complex data, there is the useful
[`gg_overview()`](https://tscnlab.github.io/LightLogR/reference/gg_overview.md)
function to get an immediate grasp of your data. It was automatically
called during import (set `auto.plot = FALSE` to suppress this), but
really shines for datasets with multiple participants. It also indicates
where data is missing, based on the measurement epochs found in the
data.

![Example for gg_overview() from a large data collection effort over
many months](reference/figures/gg_overview2.png)

Example for
[`gg_overview()`](https://tscnlab.github.io/LightLogR/reference/gg_overview.md)
from a large data collection effort over many months

*note:* the above example image requires a large dataset, not included
in the package. It is available, however, in the article on [Import &
cleaning](https://tscnlab.github.io/LightLogR/articles/Import.html).

``` R
#example code, on how to use gg_overview():
dataset %>% gg_overview()
```

### Visualize

Once imported, **LightLogR** has many convenient visualization options.

``` r
dataset %>% gg_days()
```

![](reference/figures/README-unnamed-chunk-4-1.png)

There is a wide range of options to the
[`gg_days()`](https://tscnlab.github.io/LightLogR/reference/gg_days.md)
function to customize the output. Have a look at the reference page
([`?gg_days`](https://tscnlab.github.io/LightLogR/reference/gg_days.md))
to see all options. You can also override most of the defaults, e.g.,
for different `color`, `facetting`, `theme` options. Helper functions
can prepare the data (e.g. to aggregate it to coarser intervals), or to
add to the plot (e.g., to add conditions, such as nighttime)

``` r
dataset |> 
  #change the interval from 10 seconds to 15 minutes:
  aggregate_Datetime("15 min") |> 
  #create groups of 3-hour intervals:
  cut_Datetime("3 hours") |> 
  #plot creation, with a boxplot:
  gg_days(geom = "boxplot", group = Datetime.rounded) |> 
  #adding nighttime indicators:
  gg_photoperiod(c(47.9,9)) + 
  # the output is a standard ggplot, and can be manipulated that way
  geom_line(col = "red", linewidth = 0.25) + 
  labs(title = "Personal light exposure across a week", 
       subtitle = "Boxplot in 3-hour bins")
```

![](reference/figures/README-unnamed-chunk-5-1.png)

### More than one dataset

The built-in dataset `sample.data.environment` shows a combined dataset
of light logger data and a second set of data - in this case
unobstructed outdoor light measurements. Combined datasets can be easily
visualized with
[`gg_day()`](https://tscnlab.github.io/LightLogR/reference/gg_day.md).
The `col` parameter used on the `Id` column of the dataset allows for a
color separation.

``` r
sample.data.environment %>% 
  gg_day(
    start.date = "2023-09-01",
    aes_col = Id,
    geom = "line") + 
  theme(legend.position = "bottom")
#> Only Dates will be used from start.date and end.date input. If you also want to set Datetimes or Times, consider using the `filter_Datetime()` function instead.
```

![](reference/figures/README-unnamed-chunk-6-1.png)[`gg_day()`](https://tscnlab.github.io/LightLogR/reference/gg_day.md)
will show plots always facetted by day, whereas
[`gg_days()`](https://tscnlab.github.io/LightLogR/reference/gg_days.md)
shows a timeline of days for each group. Both functions are opinionated
in terms of the scaling and linebreaks to only show whole days, all of
which can be adjusted.

There are many ways to enhance the plots - if, e.g., we look for periods
of at least 1 hour above 250 lx, we can add and then visualize these
periods easily

``` r
sample.data.environment %>% 
  #search for these conditions:
  add_clusters(MEDI > 250, cluster.duration = "30 min") |> 
  #base plot + add the condition
  gg_days() |> 
  gg_states(state, fill = "red") + 
  #standard ggplot:
  geom_hline(yintercept = 250, col = "red", linetype = "dashed") + 
  labs(title = "Periods > 250 lx mel EDI for more than 30 minutes")
```

![](reference/figures/README-unnamed-chunk-7-1.png)

There are more visualizations to try - the article on
[Visualizations](https://tscnlab.github.io/LightLogR/articles/Visualizations.html)
dives into them in-depths.

``` r
sample.data.environment |> gg_heatmap(doubleplot = "next")
```

![](reference/figures/README-unnamed-chunk-8-1.png)

### Metrics

There are many [Metrics](#metrics) used in literature for condensing
personalized light exposure time series to singular values. `LightLogR`
has a rather comprehensive number of these metrics with a consistent,
easy-to-use interface.

``` r
sample.data.environment |> # two groups: participant and environment
  filter_Date(length = "2 days") |> #filter to three days each for better overview
  group_by(Day = lubridate::date(Datetime), .add = TRUE) |>  #add grouping per day
  summarize(
    #time above 250 lx mel EDI:
    duration_above_threshold(MEDI, Datetime, threshold = 250, as.df = TRUE),
    #intradaily variability (IV):
    intradaily_variability(MEDI, Datetime, as.df = TRUE),
    #... as many more metrics as are desired
    .groups = "drop"
  )
#> # A tibble: 4 × 4
#>   Id          Day        duration_above_250    intradaily_variability
#>   <fct>       <date>     <Duration>                             <dbl>
#> 1 Environment 2023-08-29 48240s (~13.4 hours)                   0.248
#> 2 Environment 2023-08-30 49350s (~13.71 hours)                  0.168
#> 3 Participant 2023-08-29 5810s (~1.61 hours)                    1.23 
#> 4 Participant 2023-08-30 9960s (~2.77 hours)                    0.821
```

Other types of metrics can be derived less formally by the
[`durations()`](https://tscnlab.github.io/LightLogR/reference/durations.md),
`extract_state()` or `extract_cluster()` function.

``` r
dataset |> 
  gap_handler(full.days = TRUE) |> #extend the viewed time until midnight of the first and last day
  durations(MEDI, show.missing = TRUE)
#> # A tibble: 1 × 4
#> # Groups:   Id [1]
#>   Id    duration              missing               total                
#>   <fct> <Duration>            <Duration>            <Duration>           
#> 1 P1    610160s (~1.01 weeks) 81040s (~22.51 hours) 691200s (~1.14 weeks)

dataset |> 
  group_by(TAT250 = MEDI >= 250, .add = TRUE) |> #creating a grouping column that checks for values above 250lx
  durations(MEDI)
#> # A tibble: 2 × 3
#> # Groups:   Id, TAT250 [2]
#>   Id    TAT250 duration            
#>   <fct> <lgl>  <Duration>          
#> 1 P1    FALSE  498530s (~5.77 days)
#> 2 P1    TRUE   111630s (~1.29 days)
```

The second row indicates where this status is true. This will be
identical to:

``` r
dataset |> 
  summarize(
    duration_above_threshold(MEDI, Datetime, threshold = 250, as.df = TRUE),
    .groups = "drop"
  )
#> # A tibble: 1 × 2
#>   Id    duration_above_250  
#>   <fct> <Duration>          
#> 1 P1    111630s (~1.29 days)
```

What if we are interested in how often this threshold is crossed, and
for how long?

``` r
dataset |> 
  extract_states(TAT250, MEDI >= 250) |> #extract a list of states
  summarize_numeric() |> #summarize the numeric values
  select(Id, TAT250, mean_duration, episodes, total_duration) #collect a subset
#> # A tibble: 2 × 5
#> # Groups:   Id [1]
#>   Id    TAT250 mean_duration        episodes total_duration      
#>   <fct> <lgl>  <Duration>              <int> <Duration>          
#> 1 P1    FALSE  482s (~8.03 minutes)     1034 498530s (~5.77 days)
#> 2 P1    TRUE   108s (~1.8 minutes)      1034 111630s (~1.29 days)
```

We see that there are roughly one thousand instances across the week
where 250 lx was reached, but it only lasted under two minutes on
average. How many long periods are there, say above 30 minutes? As there
might be short interruption, that we consider irrelevant, we are
ignoring interruptions of 1 minute. This is the area of clusters.

``` r
dataset |> 
  extract_clusters(MEDI >= 250, #base condition
                   cluster.duration = "30 mins", #search for at least 30 minute instances
                   interruption.duration = "1 min", #allow 1 minute interrupts
                   add.label = TRUE) |> #add a description of the conditions
  group_by(label) |> #group by the label so it does not get removed next
  summarize_numeric() |> #summarize the output
  select(-mean_epoch) #collect a subset
#> # A tibble: 1 × 6
#>   label   mean_start mean_end mean_duration       total_duration        episodes
#>   <chr>   <time>     <time>   <Duration>          <Duration>               <int>
#> 1 MEDI>=… 13:50:47   15:02:14 4288s (~1.19 hours) 72890s (~20.25 hours)       17
```

We see there are only 17 instances across the week, lasting, on average,
a bit above an hour (and sitting aroung 14:00 - 15:00). Directly
relating the total duration to the 1.29 days time above 250 lx from
above would be misleading, however. This is because here, there are
interruptions present. How prominent are these interruptions?

``` r
dataset |> 
  extract_clusters(MEDI >= 250, #base condition
                   cluster.duration = "30 mins", #search for at least 30 minute instances
                   interruption.duration = "1 min", #allow 1 minute interrupts
                   add.label = TRUE) |>
  #extract the metric:
  extract_metric(dataset, rel_interrupt = sum(MEDI < 250)/n()) |> 
  summarize_numeric(prefix = "") |> #summarize the output
  select(episodes, total_duration, rel_interrupt) |>   #collect a subset
  mutate(interrupt_duration = (total_duration*rel_interrupt) |> round(), #calculate interrupt
         rel_interrupt = rel_interrupt |> scales::percent_format(1)())
#> # A tibble: 1 × 4
#>   episodes total_duration        rel_interrupt interrupt_duration    
#>      <int> <Duration>            <chr>         <Duration>            
#> 1       17 72890s (~20.25 hours) 4%            2918s (~48.63 minutes)
```

Thus we find that only about 4% of the long exposure periods are made up
of interruptions, or just shy of 50 minutes out of over 20 hours.

### Gaps and cleaning

**LightLogR** provides a range of functions to get insight into your
light logger data. Most importantly, you can search for and eliminate
implicit gaps.

``` r
sample.data.irregular |> has_irregulars()
#> [1] TRUE
sample.data.irregular |> has_gaps()
#> [1] TRUE
```

At import, we already get a sense for intervals, but can always show
them with
[`count_difftime()`](https://tscnlab.github.io/LightLogR/reference/count_difftime.md).

``` r
sample.data.irregular %>% count_difftime()
#> # A tibble: 4 × 4
#> # Groups:   Id [1]
#>   Id    difftime       n group.indices
#>   <chr> <Duration> <int>         <int>
#> 1 P1    15s        10015             1
#> 2 P1    16s         1367             1
#> 3 P1    17s           23             1
#> 4 P1    18s           16             1
```

We can eliminate this through the
[`gap_handler()`](https://tscnlab.github.io/LightLogR/reference/gap_handler.md)
function. This function will automatically fill in the gaps with NA
values. **The function will not impute or interpolate data**. As the
most dominant interval in the dataset is now not 15 seconds anymore
(because intermediate datapoints have been added), we need to specify
the epoch for
[`gap_finder()`](https://tscnlab.github.io/LightLogR/reference/gap_finder.md).

``` r
sample.data.irregular |> gap_handler() |> has_gaps(epoch = "15 secs")
#> [1] FALSE
```

If we want to force the data to be regular, we can use the
[`aggregate_Datetime()`](https://tscnlab.github.io/LightLogR/reference/aggregate_Datetime.md)
function. This will aggregate the data to the specified epoch. There are
sensible defaults on how to aggregate numeric, categorical, and logical
data. You can also specify your own aggregation functions.

``` r
sample.data.irregular |>  
  aggregate_Datetime(unit = "20 sec") |> 
  has_gaps()
#> [1] FALSE
```

There are also convenient functions to extract
([`extract_gaps()`](https://tscnlab.github.io/LightLogR/reference/extract_gaps.md)),
summarize
([`gap_table()`](https://tscnlab.github.io/LightLogR/reference/gap_table.md))
or visualize
([`gg_gaps()`](https://tscnlab.github.io/LightLogR/reference/gg_gaps.md))
gaps.

``` r
dataset |> gg_gaps()
#> Warning: Removed 8104 rows containing missing values or values outside the scale range
#> (`geom_line()`).
```

![](reference/figures/README-unnamed-chunk-19-1.png)

Finally, the
[`remove_partial_data()`](https://tscnlab.github.io/LightLogR/reference/remove_partial_data.md)
easily gets rid of groups or days that do not provide enough data.

``` r
dataset |> 
  remove_partial_data(MEDI, #variable for which to check missingness
                      threshold.missing = "2 hours", #remove when more than 2 hours are missing
                      by.date = TRUE, #check the condition per day, not the whole participant
                      handle.gaps = TRUE) |>  #go beyond the available data to midnight of the first and last day
  gg_days()
```

![](reference/figures/README-unnamed-chunk-20-1.png)

## Supported devices

At present, these are the devices we support in LightLogR:

- Actiwatch_Spectrum

- Actiwatch_Spectrum_de

- ActLumus

- ActTrust

- Circadian_Eye

- Clouclip

- DeLux

- GENEActiv_GGIR

- Kronowise

- LiDo

- LightWatcher

- LIMO

- LYS

- MiEye

- MotionWatch8

- nanoLambda

- OcuWEAR

- Speccy

- SpectraWear

- VEET

More Information on these devices can be found in the reference for
[`import_Dataset()`](https://tscnlab.github.io/LightLogR/reference/import_Dataset.md).
If you want to know how to import data from these devices, have a look
at our article on [Import &
Cleaning](https://tscnlab.github.io/LightLogR/articles/Import.html).

If you are using a device that is currently not supported, please
contact the developers. We are always looking to expand the range of
supported devices. The easiest and most trackable way to get in contact
is by opening a new issue on our [Github
repository](https://github.com/tscnlab/LightLogR/issues). Please also
provide a sample file of your data, so we can test the import function.

## Metrics

LightLogR supports a wide range of metrics across different metric
families. You can find the full documentation of metrics functions in
the [reference
section](https://tscnlab.github.io/LightLogR/reference/index.html#metrics).
There is also an overview article on how to use
[Metrics](https://tscnlab.github.io/LightLogR/articles/Metrics.html).

| Metric Family                        | Submetrics     | Note                 | Documentation                                                                                                                                                                                                                                                                                                                                                |
|--------------------------------------|----------------|----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Barroso                              | 7              |                      | [`barroso_lighting_metrics()`](https://tscnlab.github.io/LightLogR/reference/barroso_lighting_metrics.md)                                                                                                                                                                                                                                                    |
| Bright-dark period                   | 4x2            | bright / dark        | [`bright_dark_period()`](https://tscnlab.github.io/LightLogR/reference/bright_dark_period.md)                                                                                                                                                                                                                                                                |
| Centroid of light exposure           | 1              |                      | [`centroidLE()`](https://tscnlab.github.io/LightLogR/reference/centroidLE.md)                                                                                                                                                                                                                                                                                |
| Dose                                 | 1              |                      | [`dose()`](https://tscnlab.github.io/LightLogR/reference/dose.md)                                                                                                                                                                                                                                                                                            |
| Disparity index                      | 1              |                      | [`disparity_index()`](https://tscnlab.github.io/LightLogR/reference/disparity_index.md)                                                                                                                                                                                                                                                                      |
| Duration above threshold             | 3              | above, below, within | [`duration_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/duration_above_threshold.md)                                                                                                                                                                                                                                                    |
| Exponential moving average (EMA)     | 1              |                      | [`exponential_moving_average()`](https://tscnlab.github.io/LightLogR/reference/exponential_moving_average.md)                                                                                                                                                                                                                                                |
| Frequency crossing threshold         | 1              |                      | [`frequency_crossing_threshold()`](https://tscnlab.github.io/LightLogR/reference/frequency_crossing_threshold.md)                                                                                                                                                                                                                                            |
| Intradaily Variance (IV)             | 1              |                      | [`intradaily_variability()`](https://tscnlab.github.io/LightLogR/reference/intradaily_variability.md)                                                                                                                                                                                                                                                        |
| Interdaily Stability (IS)            | 1              |                      | [`interdaily_stability()`](https://tscnlab.github.io/LightLogR/reference/interdaily_stability.md)                                                                                                                                                                                                                                                            |
| Midpoint CE (Cumulative Exposure)    | 1              |                      | [`midpointCE()`](https://tscnlab.github.io/LightLogR/reference/midpointCE.md)                                                                                                                                                                                                                                                                                |
| nvRC (Non-visual circadian response) | 4              |                      | [`nvRC()`](https://tscnlab.github.io/LightLogR/reference/nvRC.md), [`nvRC_circadianDisturbance()`](https://tscnlab.github.io/LightLogR/reference/nvRC_metrics.md), [`nvRC_circadianBias()`](https://tscnlab.github.io/LightLogR/reference/nvRC_metrics.md), [`nvRC_relativeAmplitudeError()`](https://tscnlab.github.io/LightLogR/reference/nvRC_metrics.md) |
| nvRD (Non-visual direct response)    | 2              |                      | [`nvRD()`](https://tscnlab.github.io/LightLogR/reference/nvRD.md), [`nvRD_cumulative_response()`](https://tscnlab.github.io/LightLogR/reference/nvRD_cumulative_response.md)                                                                                                                                                                                 |
| Period above threshold               | 3              | above, below, within | [`period_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/period_above_threshold.md)                                                                                                                                                                                                                                                        |
| Pulses above threshold               | 7x3            | above, below, within | [`pulses_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/pulses_above_threshold.md)                                                                                                                                                                                                                                                        |
| Threshold for duration               | 2              | above, below         | [`threshold_for_duration()`](https://tscnlab.github.io/LightLogR/reference/threshold_for_duration.md)                                                                                                                                                                                                                                                        |
| Timing above threshold               | 3              | above, below, within | [`timing_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/timing_above_threshold.md)                                                                                                                                                                                                                                                        |
| **Total:**                           |                |                      |                                                                                                                                                                                                                                                                                                                                                              |
| **17 families**                      | **62 metrics** |                      |                                                                                                                                                                                                                                                                                                                                                              |

If you would like to use a metric you don’t find represented in
LightLogR, please contact the developers. The easiest and most trackable
way to get in contact is by opening a new issue on our [Github
repository](https://github.com/tscnlab/LightLogR/issues).

## About the creation and funding of LightLogR

**LightLogR** is developed by the [*Translational Sensory & Circadian
Neuroscience*](https://www.tscnlab.org) lab, a joint group from the
[Technical University of Munich](https://www.tum.de/en/) and the [Max
Planck Institute for Biological Neuroscience Unit
(MPS/TUM/TUMCREATE)\*](https://www.tscnlab.org), a joint group based at
the [Technical University of Munich](https://www.tum.de/en/),
[TUMCREATE](https://www.tum-create.edu.sg/), the [Max Planck Institute
for Biological
Cybernetics](https://www.mpg.de/152075/biological-cybernetics).

[*MeLiDos*](https://www.melidos.eu) is a joint,
[EURAMET](https://www.euramet.org)-funded project involving sixteen
partners across Europe, aimed at developing a metrology and a standard
workflow for wearable light logger data and optical radiation
dosimeters. Its primary contributions towards fostering FAIR data
include the development of a common file format, robust metadata
descriptors, and an accompanying open-source software ecosystem.

[![](reference/figures/Metrology_Partnership_LOGO.jpg)](https://www.euramet.org)
![](reference/figures/Co-Funded-By-the-EU.png)

The project (22NRM05 MeLiDos) has received funding from the European
Partnership on Metrology, co-financed from the European Union’s Horizon
Europe Research and Innovation Programme and by the Participating
States. Views and opinions expressed are however those of the author(s)
only and do not necessarily reflect those of the European Union or
EURAMET. Neither the European Union nor the granting authority can be
held responsible for them.

**LightLogR** is further supported throught the [Wellcome
trust](https://wellcome.org) and the [GLEE
project](https://www.visualdiet.org) (Global Light exposure engine).

![](pkgdown/assets/Wellcome_Trust_logo.svg.png)![](pkgdown/assets/logo_glee-2.png)

# I Want To Contribute

All types of contributions are encouraged and valued. See the
[CONTRIBUTING](https://tscnlab.github.io/LightLogR/CONTRIBUTING.html)
section for different ways to help and details about how this project
handles them. This project and everyone participating in it is governed
by the [LightLogR Code of
Conduct](https://tscnlab.github.io/LightLogR/CODE_OF_CONDUCT.html).

# Package index

## Import

Wearable light logger data can be imported from a variety of sources,
i.e., exports from measurement devices or online databases. This section
also includes functions to import auxiliary data, such as sleep/wake
data. The family of import functions works on a variety of
device-specific files through `import_*()`.

- [`import_adjustment()`](https://tscnlab.github.io/LightLogR/reference/import_adjustment.md)
  : Adjust device imports or make your own

- [`import_Dataset()`](https://tscnlab.github.io/LightLogR/reference/import_Dataset.md)
  [`import`](https://tscnlab.github.io/LightLogR/reference/import_Dataset.md)
  : Import a light logger dataset or related data

- [`import_Statechanges()`](https://tscnlab.github.io/LightLogR/reference/import_Statechanges.md)
  :

  Import data that contain `Datetimes` of `Statechanges`

## Insight

Functions to gain more insight into the data. Functions in this section
will not return a version of the input dataset, but rather information
based on it.

- [`count_difftime()`](https://tscnlab.github.io/LightLogR/reference/count_difftime.md)
  : Counts the Time differences (epochs) per group (in a grouped
  dataset)
- [`dominant_epoch()`](https://tscnlab.github.io/LightLogR/reference/dominant_epoch.md)
  : Determine the dominant epoch/interval of a dataset
- [`dst_change_summary()`](https://tscnlab.github.io/LightLogR/reference/dst_change_summary.md)
  : Get a summary of groups where a daylight saving time change occurs.
- [`durations()`](https://tscnlab.github.io/LightLogR/reference/durations.md)
  : Calculate duration of data in each group
- [`photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`extract_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`add_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`solar_noon()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  : Calculate photoperiod and boundary times
- [`extract_clusters()`](https://tscnlab.github.io/LightLogR/reference/extract_clusters.md)
  [`add_clusters()`](https://tscnlab.github.io/LightLogR/reference/extract_clusters.md)
  : Find and extract clusters from a dataset
- [`extract_states()`](https://tscnlab.github.io/LightLogR/reference/extract_states.md)
  : Extract summaries of states
- [`extract_metric()`](https://tscnlab.github.io/LightLogR/reference/extract_metric.md)
  : Add metrics to extracted sSummary
- [`extract_gaps()`](https://tscnlab.github.io/LightLogR/reference/extract_gaps.md)
  : Extract gap episodes from the data
- [`gapless_Datetimes()`](https://tscnlab.github.io/LightLogR/reference/gapless_Datetimes.md)
  : Create a gapless sequence of Datetimes
- [`gap_finder()`](https://tscnlab.github.io/LightLogR/reference/gap_finder.md)
  : Check for and output gaps in a dataset
- [`gap_table()`](https://tscnlab.github.io/LightLogR/reference/gap_table.md)
  : Tabular summary of data and gaps in all groups
- [`has_gaps()`](https://tscnlab.github.io/LightLogR/reference/has_gaps.md)
  : Does a dataset have implicit gaps
- [`has_irregulars()`](https://tscnlab.github.io/LightLogR/reference/has_irregulars.md)
  : Does a dataset have irregular data
- [`summary_overview()`](https://tscnlab.github.io/LightLogR/reference/summary_table.md)
  [`summary_metrics()`](https://tscnlab.github.io/LightLogR/reference/summary_table.md)
  [`summary_table()`](https://tscnlab.github.io/LightLogR/reference/summary_table.md)
  : Light exposure summary table helpers

## Process

Functions to process light logger data, e.g., to validate and clean
data, to filter, cut or aggreagate data, or to join datasets. All of
these functions will return a version of the input dataset.

- [`add_Time_col()`](https://tscnlab.github.io/LightLogR/reference/add_Time_col.md)
  : Create a Time-of-Day column in the dataset
- [`add_Date_col()`](https://tscnlab.github.io/LightLogR/reference/add_Date_col.md)
  : Create a Date column in the dataset
- [`aggregate_Date()`](https://tscnlab.github.io/LightLogR/reference/aggregate_Date.md)
  : Aggregate dates to a single day
- [`aggregate_Datetime()`](https://tscnlab.github.io/LightLogR/reference/aggregate_Datetime.md)
  : Aggregate Datetime data
- [`create_Timedata()`](https://tscnlab.github.io/LightLogR/reference/create_Timedata.md)
  : create_Timedata
- [`cut_Datetime()`](https://tscnlab.github.io/LightLogR/reference/cut_Datetime.md)
  : Create Datetime bins for visualization and calculation
- [`dst_change_handler()`](https://tscnlab.github.io/LightLogR/reference/dst_change_handler.md)
  : Handle jumps in Daylight Savings (DST) that are missing in the data
- [`filter_Datetime()`](https://tscnlab.github.io/LightLogR/reference/filter_Datetime.md)
  [`filter_Date()`](https://tscnlab.github.io/LightLogR/reference/filter_Datetime.md)
  : Filter Datetimes in a dataset.
- [`filter_Datetime_multiple()`](https://tscnlab.github.io/LightLogR/reference/filter_Datetime_multiple.md)
  : Filter multiple times based on a list of arguments.
- [`filter_Time()`](https://tscnlab.github.io/LightLogR/reference/filter_Time.md)
  : Filter Times in a dataset.
- [`gap_handler()`](https://tscnlab.github.io/LightLogR/reference/gap_handler.md)
  : Fill implicit gaps in a light logger dataset
- [`join_datasets()`](https://tscnlab.github.io/LightLogR/reference/join_datasets.md)
  : Join similar Datasets
- [`remove_partial_data()`](https://tscnlab.github.io/LightLogR/reference/remove_partial_data.md)
  : Remove groups that have too few data points

## Expand

Expanding light logger data through auxiliary data and/or reference data
allows for a more comprehensive analysis.

- [`photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`extract_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`add_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`solar_noon()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  : Calculate photoperiod and boundary times
- [`extract_clusters()`](https://tscnlab.github.io/LightLogR/reference/extract_clusters.md)
  [`add_clusters()`](https://tscnlab.github.io/LightLogR/reference/extract_clusters.md)
  : Find and extract clusters from a dataset
- [`add_states()`](https://tscnlab.github.io/LightLogR/reference/add_states.md)
  : Add states to a dataset based on groups and start/end times
- [`Brown2reference()`](https://tscnlab.github.io/LightLogR/reference/Brown2reference.md)
  : Add Brown et al. (2022) reference illuminance to a dataset
- [`Brown_check()`](https://tscnlab.github.io/LightLogR/reference/Brown_check.md)
  : Check whether a value is within the recommended illuminance/MEDI
  levels by Brown et al. (2022)
- [`Brown_cut()`](https://tscnlab.github.io/LightLogR/reference/Brown_cut.md)
  : Create a state column that cuts light levels into sections by Brown
  et al. (2022)
- [`Brown_rec()`](https://tscnlab.github.io/LightLogR/reference/Brown_rec.md)
  : Set the recommended illuminance/MEDI levels by Brown et al. (2022)
- [`data2reference()`](https://tscnlab.github.io/LightLogR/reference/data2reference.md)
  : Create reference data from other data
- [`interval2state()`](https://tscnlab.github.io/LightLogR/reference/interval2state.md)
  : Adds a state column to a dataset from interval data
- [`number_states()`](https://tscnlab.github.io/LightLogR/reference/number_states.md)
  : Number non-consecutive state occurrences
- [`sc2interval()`](https://tscnlab.github.io/LightLogR/reference/sc2interval.md)
  : Statechange (sc) Timestamps to Intervals
- [`sleep_int2Brown()`](https://tscnlab.github.io/LightLogR/reference/sleep_int2Brown.md)
  : Recode Sleep/Wake intervals to Brown state intervals
- [`spectral_reconstruction()`](https://tscnlab.github.io/LightLogR/reference/spectral_reconstruction.md)
  : Reconstruct spectral irradiance from sensor counts

## Visualize

Functions to visualize light logger data, e.g., to plot light exposure
or to plot sleep/wake data.

- [`gg_day()`](https://tscnlab.github.io/LightLogR/reference/gg_day.md)
  : Create a simple Time-of-Day plot of light logger data, faceted by
  Date
- [`gg_days()`](https://tscnlab.github.io/LightLogR/reference/gg_days.md)
  : Create a simple datetime plot of light logger data, faceted by group
- [`gg_doubleplot()`](https://tscnlab.github.io/LightLogR/reference/gg_doubleplot.md)
  : Double Plots
- [`gg_gaps()`](https://tscnlab.github.io/LightLogR/reference/gg_gaps.md)
  : Visualize gaps and irregular data
- [`gg_heatmap()`](https://tscnlab.github.io/LightLogR/reference/gg_heatmap.md)
  : Plot a heatmap across days and times of day
- [`gg_overview()`](https://tscnlab.github.io/LightLogR/reference/gg_overview.md)
  : Plot an overview of dataset intervals with implicit missing data
- [`gg_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/gg_photoperiod.md)
  : Add photoperiods to gg_day() or gg_days() plots
- [`gg_state()`](https://tscnlab.github.io/LightLogR/reference/gg_state.md)
  **\[deprecated\]** : Add states to gg_day() or gg_days() plots
- [`gg_states()`](https://tscnlab.github.io/LightLogR/reference/gg_states.md)
  : Add states to gg_day() or gg_days() plots

## Metrics

Functions to calculate light exposure metrics.

- [`barroso_lighting_metrics()`](https://tscnlab.github.io/LightLogR/reference/barroso_lighting_metrics.md)
  : Circadian lighting metrics from Barroso et al. (2014)
- [`bright_dark_period()`](https://tscnlab.github.io/LightLogR/reference/bright_dark_period.md)
  : Brightest or darkest continuous period
- [`centroidLE()`](https://tscnlab.github.io/LightLogR/reference/centroidLE.md)
  : Centroid of light exposure
- [`disparity_index()`](https://tscnlab.github.io/LightLogR/reference/disparity_index.md)
  : Disparity index
- [`dose()`](https://tscnlab.github.io/LightLogR/reference/dose.md) :
  Calculate the dose (value·hours)
- [`duration_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/duration_above_threshold.md)
  : Duration above/below threshold or within threshold range
- [`exponential_moving_average()`](https://tscnlab.github.io/LightLogR/reference/exponential_moving_average.md)
  : Exponential moving average filter (EMA)
- [`frequency_crossing_threshold()`](https://tscnlab.github.io/LightLogR/reference/frequency_crossing_threshold.md)
  : Frequency of crossing light threshold
- [`intradaily_variability()`](https://tscnlab.github.io/LightLogR/reference/intradaily_variability.md)
  : Intradaily variability (IV)
- [`interdaily_stability()`](https://tscnlab.github.io/LightLogR/reference/interdaily_stability.md)
  : Interdaily stability (IS)
- [`midpointCE()`](https://tscnlab.github.io/LightLogR/reference/midpointCE.md)
  : Midpoint of cumulative light exposure.
- [`nvRC()`](https://tscnlab.github.io/LightLogR/reference/nvRC.md) :
  Non-visual circadian response
- [`nvRC_circadianDisturbance()`](https://tscnlab.github.io/LightLogR/reference/nvRC_metrics.md)
  [`nvRC_circadianBias()`](https://tscnlab.github.io/LightLogR/reference/nvRC_metrics.md)
  [`nvRC_relativeAmplitudeError()`](https://tscnlab.github.io/LightLogR/reference/nvRC_metrics.md)
  : Performance metrics for circadian response
- [`nvRD()`](https://tscnlab.github.io/LightLogR/reference/nvRD.md) :
  Non-visual direct response
- [`nvRD_cumulative_response()`](https://tscnlab.github.io/LightLogR/reference/nvRD_cumulative_response.md)
  : Cumulative non-visual direct response
- [`period_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/period_above_threshold.md)
  : Length of longest continuous period above/below threshold
- [`pulses_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/pulses_above_threshold.md)
  : Pulses above threshold
- [`spectral_integration()`](https://tscnlab.github.io/LightLogR/reference/spectral_integration.md)
  : Integrate spectral irradiance with optional weighting
- [`threshold_for_duration()`](https://tscnlab.github.io/LightLogR/reference/threshold_for_duration.md)
  : Find threshold for given duration
- [`timing_above_threshold()`](https://tscnlab.github.io/LightLogR/reference/timing_above_threshold.md)
  : Mean/first/last timing above/below threshold.

## Photoperiod

Functions that deal with photoperiod aspects of a dataset

- [`photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`extract_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`add_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`solar_noon()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  : Calculate photoperiod and boundary times
- [`gg_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/gg_photoperiod.md)
  : Add photoperiods to gg_day() or gg_days() plots

## Helpers

Helper functions that are used in the other sections.

- [`Circular2Time()`](https://tscnlab.github.io/LightLogR/reference/Circular2Time.md)
  : Convert circular time columns to hms
- [`Datetime2Time()`](https://tscnlab.github.io/LightLogR/reference/Datetime2Time.md)
  : Convert Datetime columns to Time columns
- [`Datetime_breaks()`](https://tscnlab.github.io/LightLogR/reference/Datetime_breaks.md)
  : Create a (shifted) sequence of Datetimes for axis breaks
- [`Datetime_limits()`](https://tscnlab.github.io/LightLogR/reference/Datetime_limits.md)
  : Find or set sensible limits for Datetime axis
- [`log_zero_inflated()`](https://tscnlab.github.io/LightLogR/reference/log_zero_inflated.md)
  [`exp_zero_inflated()`](https://tscnlab.github.io/LightLogR/reference/log_zero_inflated.md)
  : Add a defined number to a numeric and log transform it
- [`format_coordinates()`](https://tscnlab.github.io/LightLogR/reference/format_coordinates.md)
  : Format coordinates as a readable string
- [`mean_daily()`](https://tscnlab.github.io/LightLogR/reference/mean_daily.md)
  : Calculate mean daily metrics from daily summary
- [`mean_daily_metric()`](https://tscnlab.github.io/LightLogR/reference/mean_daily_metric.md)
  : Calculate mean daily metrics from Time Series
- [`normalize_counts()`](https://tscnlab.github.io/LightLogR/reference/normalize_counts.md)
  : Normalize counts between sensor outputs
- [`photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`extract_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`add_photoperiod()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  [`solar_noon()`](https://tscnlab.github.io/LightLogR/reference/photoperiod.md)
  : Calculate photoperiod and boundary times
- [`reverse2_trans()`](https://tscnlab.github.io/LightLogR/reference/reverse2_trans.md)
  : Create a reverse transformation function specifically for date
  scales
- [`sample_groups()`](https://tscnlab.github.io/LightLogR/reference/sample_groups.md)
  : Sample groups from a grouped dataset
- [`spectral_reconstruction()`](https://tscnlab.github.io/LightLogR/reference/spectral_reconstruction.md)
  : Reconstruct spectral irradiance from sensor counts
- [`style_time()`](https://tscnlab.github.io/LightLogR/reference/style_time.md)
  : Style (date)times as times
- [`summarize_numeric()`](https://tscnlab.github.io/LightLogR/reference/summarize_numeric.md)
  [`summarise_numeric()`](https://tscnlab.github.io/LightLogR/reference/summarize_numeric.md)
  : Summarize numeric columns in dataframes to means
- [`symlog_trans()`](https://tscnlab.github.io/LightLogR/reference/symlog_trans.md)
  : Scale positive and negative values on a log scale

## Datasets

Datasets that are used in LightLogR and in examples.

- [`alphaopic.action.spectra`](https://tscnlab.github.io/LightLogR/reference/alphaopic.action.spectra.md)
  : Alphaopic (+ photopic) action spectra
- [`gain.ratio.tables`](https://tscnlab.github.io/LightLogR/reference/gain.ratio.tables.md)
  : Gain / Gain-ratio tables to normalize counts
- [`ll_import_expr()`](https://tscnlab.github.io/LightLogR/reference/ll_import_expr.md)
  : Get the import expression for a device
- [`sample.data.environment`](https://tscnlab.github.io/LightLogR/reference/sample.data.environment.md)
  : Sample of wearable data combined with environmental data
- [`sample.data.irregular`](https://tscnlab.github.io/LightLogR/reference/sample.data.irregular.md)
  : Sample of highly irregular wearable data
- [`supported_devices()`](https://tscnlab.github.io/LightLogR/reference/supported_devices.md)
  : Get all the supported devices in LightLogR
- [`supported_versions()`](https://tscnlab.github.io/LightLogR/reference/supported_versions.md)
  : Get all the supported device-formats in LightLogR

# Articles

### All vignettes

- [The whole game](https://tscnlab.github.io/LightLogR/articles/Day.md):
- [Import &
  cleaning](https://tscnlab.github.io/LightLogR/articles/Import.md):
- [Log
  transformation](https://tscnlab.github.io/LightLogR/articles/log.md):
- [Metrics](https://tscnlab.github.io/LightLogR/articles/Metrics.md):
- [Photoperiod](https://tscnlab.github.io/LightLogR/articles/photoperiod.md):
- [Light
  spectrum](https://tscnlab.github.io/LightLogR/articles/spectrum.md):
- [Durations, states and
  clusters](https://tscnlab.github.io/LightLogR/articles/states.md):
- [Visualizations](https://tscnlab.github.io/LightLogR/articles/Visualizations.md):
