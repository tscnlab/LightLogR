<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate photoperiod and boundary times — photoperiod • LightLogR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate photoperiod and boundary times — photoperiod"><meta name="description" content='A family of functions to extract and add photoperiod information.
photoperiod() creates a tibble with the calculated times of dawn and dusk
for the given location and date. The function is a convenience wrapper for
suntools::crepuscule() to calculate the times of dawn and dusk. By default,
civil dawn and dusk are calculated, but the function can be used to calculate
other times by changing the solarDep parameter (e.g., 0 for sunrise/sunset,
12 for nautical, and 18 for astronomical).
Taking a light exposure dataset as input, extract_photoperiod() calculates
the photoperiods and their boundary times for each unique day in the dataset,
given a location and boundary condition (i.e., the solar depression angle).
Basically, this is a convenience wrapper for photoperiod() that takes a
light logger dataset and extracts unique dates and the time zone from the
dataset.
add_photoperiod() adds photoperiod information to a light logger dataset.
Beyond the photoperiod information, it will categorize the
photoperiod.state as "day" or "night". If overwrite is set to TRUE,
the function will overwrite any columns with the same name.
solar_noon() calculates the solar noon for a given location and date. The
function is a convenience wrapper for suntools::solarnoon(). The function
has no companions like extract_photoperiod() or add_photoperiod(), but
will be extended, if there is sufficient interest.'><meta property="og:description" content='A family of functions to extract and add photoperiod information.
photoperiod() creates a tibble with the calculated times of dawn and dusk
for the given location and date. The function is a convenience wrapper for
suntools::crepuscule() to calculate the times of dawn and dusk. By default,
civil dawn and dusk are calculated, but the function can be used to calculate
other times by changing the solarDep parameter (e.g., 0 for sunrise/sunset,
12 for nautical, and 18 for astronomical).
Taking a light exposure dataset as input, extract_photoperiod() calculates
the photoperiods and their boundary times for each unique day in the dataset,
given a location and boundary condition (i.e., the solar depression angle).
Basically, this is a convenience wrapper for photoperiod() that takes a
light logger dataset and extracts unique dates and the time zone from the
dataset.
add_photoperiod() adds photoperiod information to a light logger dataset.
Beyond the photoperiod information, it will categorize the
photoperiod.state as "day" or "night". If overwrite is set to TRUE,
the function will overwrite any columns with the same name.
solar_noon() calculates the solar noon for a given location and date. The
function is a convenience wrapper for suntools::solarnoon(). The function
has no companions like extract_photoperiod() or add_photoperiod(), but
will be extended, if there is sufficient interest.'><meta property="og:image" content="https://tscnlab.github.io/LightLogR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LightLogR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Day.html">The whole game</a></li>
    <li><a class="dropdown-item" href="../articles/Import.html">Import &amp; cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/log.html">Log transformation</a></li>
    <li><a class="dropdown-item" href="../articles/Metrics.html">Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/photoperiod.html">Photoperiod</a></li>
    <li><a class="dropdown-item" href="../articles/spectrum.html">Light Spectrum</a></li>
    <li><a class="dropdown-item" href="../articles/states.html">Durations, States and Clusters</a></li>
    <li><a class="dropdown-item" href="../articles/Visualizations.html">Visualizations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tscnlab/LightLogR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate photoperiod and boundary times</h1>
      <small class="dont-index">Source: <a href="https://github.com/tscnlab/LightLogR/blob/v0.9.0/R/photoperiod.R" class="external-link"><code>R/photoperiod.R</code></a></small>
      <div class="d-none name"><code>photoperiod.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A family of functions to extract and add photoperiod information.
<code>photoperiod()</code> creates a <code>tibble</code> with the calculated times of dawn and dusk
for the given location and date. The function is a convenience wrapper for
<code><a href="https://rdrr.io/pkg/suntools/man/crepuscule.html" class="external-link">suntools::crepuscule()</a></code> to calculate the times of dawn and dusk. By default,
civil dawn and dusk are calculated, but the function can be used to calculate
other times by changing the <code>solarDep</code> parameter (e.g., 0 for sunrise/sunset,
12 for nautical, and 18 for astronomical).</p>
<p>Taking a light exposure dataset as input, <code>extract_photoperiod()</code> calculates
the photoperiods and their boundary times for each unique day in the dataset,
given a location and boundary condition (i.e., the solar depression angle).
Basically, this is a convenience wrapper for <code>photoperiod()</code> that takes a
light logger dataset and extracts unique dates and the time zone from the
dataset.</p>
<p><code>add_photoperiod()</code> adds photoperiod information to a light logger dataset.
Beyond the photoperiod information, it will categorize the
<code>photoperiod.state</code> as <code>"day"</code> or <code>"night"</code>. If <code>overwrite</code> is set to <code>TRUE</code>,
the function will overwrite any columns with the same name.</p>
<p><code>solar_noon()</code> calculates the solar noon for a given location and date. The
function is a convenience wrapper for <code><a href="https://rdrr.io/pkg/suntools/man/solarnoon.html" class="external-link">suntools::solarnoon()</a></code>. The function
has no companions like <code>extract_photoperiod()</code> or <code>add_photoperiod()</code>, but
will be extended, if there is sufficient interest.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">photoperiod</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">dates</span>, <span class="va">tz</span>, solarDep <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">extract_photoperiod</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">coordinates</span>,</span>
<span>  Datetime.colname <span class="op">=</span> <span class="va">Datetime</span>,</span>
<span>  solarDep <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_photoperiod</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">coordinates</span>,</span>
<span>  Datetime.colname <span class="op">=</span> <span class="va">Datetime</span>,</span>
<span>  solarDep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">solar_noon</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">dates</span>, <span class="va">tz</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-coordinates">coordinates<a class="anchor" aria-label="anchor" href="#arg-coordinates"></a></dt>
<dd><p>A two element numeric vector representing the latitude and
longitude of the location. <em>Important note: <strong>Latitude</strong> is the first
element and <strong>Longitude</strong> is the second element.</em></p></dd>


<dt id="arg-dates">dates<a class="anchor" aria-label="anchor" href="#arg-dates"></a></dt>
<dd><p>A date of format <code>Date</code>, or coercible to <code>Date</code> through
<code><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">lubridate::as_date()</a></code></p></dd>


<dt id="arg-tz">tz<a class="anchor" aria-label="anchor" href="#arg-tz"></a></dt>
<dd><p>Timezone of the data. Expects a <code>character</code>. You can look up the
supported timezones with <code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames()</a></code>.</p></dd>


<dt id="arg-solardep">solarDep<a class="anchor" aria-label="anchor" href="#arg-solardep"></a></dt>
<dd><p>A numerical value representing the solar depression angle
between 90 and -90. This means a value of 6 equals <strong>-6</strong> degrees above the
horizon. Default is 6, equalling <code>Civil dawn/dusk</code>. Other common values are
12 degrees for <code>Nautical dawn/dusk</code>, 18 degrees for <code>Astronomical dawn/dusk</code>, and 0 degrees for <code>Sunrise/Sunset</code>. Note that the output
columns will always be named <code>dawn</code> and <code>dusk</code>, regardless of the
<code>solarDep</code> value.</p></dd>


<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A light logger dataset. Expects a <code>dataframe</code>. If not imported
by <a href="LightLogR-package.html">LightLogR</a>, take care to choose a sensible variable for the
<code>Datetime.colname</code>.</p></dd>


<dt id="arg-datetime-colname">Datetime.colname<a class="anchor" aria-label="anchor" href="#arg-datetime-colname"></a></dt>
<dd><p>column name that contains the datetime. Defaults to
<code>"Datetime"</code> which is automatically correct for data imported with
<a href="LightLogR-package.html">LightLogR</a>. Expects a <code>symbol</code>. Needs to be part of the <code>dataset</code>. Must
be of type <code>POSIXct</code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical scalar. If <code>TRUE</code>, the function will overwrite any
columns with the same name. If <code>FALSE</code> (default), the function will stop if
any of the columns already exist in the dataset.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>photoperiod()</code> returns a <code>tibble</code> with the calculated times of dawn
and dusk for the given location and date, with the length equal to the
<code>dates</code> input parameter . The tibble contains the following columns:</p><ul><li><p><code>date</code> with the date of the calculation, stored as class <code>Date</code></p></li>
<li><p><code>tz</code> with the timezone of the output, stored as class <code>character</code></p></li>
<li><p><code>lat</code> and <code>lon</code> with the latitude and longitude of the location, stored
as class <code>numeric</code></p></li>
<li><p><code>solar.angle</code> with the negative solar depression angle, i.e. the sun
elevation above the horizon. stored as class <code>numeric</code></p></li>
<li><p><code>dawn</code> and <code>dusk</code> with the calculated datetimes, stored as class <code>POSIXct</code></p></li>
<li><p><code>photoperiod</code> with the calculated photoperiod, stored as class <code>difftime</code>.</p></li>
</ul><p><code>extract_photoperiod()</code> returns a <code>tibble</code> of the same structure as
<code>photoperiod()</code>, but with a length equal to the number of unique dates in
the dataset.</p>
<p>add_photoperiod returns the input dataset with the added
photoperiod information. The information is appended with the following
columns: <code>dawn</code>, <code>dusk</code>, <code>photoperiod</code>, and <code>photoperiod.state</code>.</p>
<p><code>solar_noon()</code> returns a <code>tibble</code> with the calculated solar noon</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Please note that all functions of the <code>photoperiod</code> family work with one
coordinate pair at a time. If you have multiple locations (and multiple time
zones), you need to run the function for each location separately. We suggest
using a nested dataframe structure, and employ the <code>purrr</code> package to iterate
over the locations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other photoperiod:
<code><a href="gg_photoperiod.html">gg_photoperiod</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="co">#example für Tübingen, Germany</span></span></span>
<span class="r-in"><span> <span class="va">coordinates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">48.521637</span>, <span class="fl">9.057645</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-06-01"</span>, <span class="st">"2025-08-23"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">tz</span> <span class="op">&lt;-</span> <span class="st">"Europe/Berlin"</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co">#civil dawn/dusk</span></span></span>
<span class="r-in"><span> <span class="fu">photoperiod</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">dates</span>, <span class="va">tz</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         date            tz      lat      lon solar.angle                dawn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-06-01 Europe/Berlin 48.52164 9.057645          -6 2023-06-01 04:46:05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2025-08-23 Europe/Berlin 48.52164 9.057645          -6 2025-08-23 05:55:03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  dusk    photoperiod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-06-01 21:57:43 17.19384 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2025-08-23 20:56:37 15.02618 hours</span>
<span class="r-in"><span> <span class="co">#sunrise/sunset</span></span></span>
<span class="r-in"><span> <span class="fu">photoperiod</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">dates</span>, <span class="va">tz</span>, solarDep <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         date            tz      lat      lon solar.angle                dawn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-06-01 Europe/Berlin 48.52164 9.057645           0 2023-06-01 05:32:42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2025-08-23 Europe/Berlin 48.52164 9.057645           0 2025-08-23 06:33:53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  dusk    photoperiod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-06-01 21:10:59 15.63821 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2025-08-23 20:17:52 13.73304 hours</span>
<span class="r-in"><span> <span class="co">#extract_photoperiod</span></span></span>
<span class="r-in"><span> <span class="va">sample.data.environment</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>   <span class="fu">extract_photoperiod</span><span class="op">(</span><span class="va">coordinates</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         date            tz      lat      lon solar.angle                dawn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-08-29 Europe/Berlin 48.52164 9.057645          -6 2023-08-29 06:03:20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2023-08-30 Europe/Berlin 48.52164 9.057645          -6 2023-08-30 06:04:50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2023-08-31 Europe/Berlin 48.52164 9.057645          -6 2023-08-31 06:06:20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2023-09-01 Europe/Berlin 48.52164 9.057645          -6 2023-09-01 06:07:50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2023-09-02 Europe/Berlin 48.52164 9.057645          -6 2023-09-02 06:09:19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2023-09-03 Europe/Berlin 48.52164 9.057645          -6 2023-09-03 06:10:48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  dusk    photoperiod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-08-29 20:45:14 14.69838 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2023-08-30 20:43:08 14.63828 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2023-08-31 20:41:01 14.57813 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2023-09-01 20:38:54 14.51793 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2023-09-02 20:36:47 14.45769 hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2023-09-03 20:34:39 14.39742 hours</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#add_photoperiod</span></span></span>
<span class="r-in"><span><span class="va">added_photoperiod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="va">sample.data.environment</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span> <span class="fu">add_photoperiod</span><span class="op">(</span><span class="va">coordinates</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">added_photoperiod</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Id [1]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Id          Datetime             MEDI dawn                dusk               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Participant 2023-08-29 <span style="color: #949494;">00:00:04</span>     0 2023-08-29 <span style="color: #949494;">06:03:20</span> 2023-08-29 <span style="color: #949494;">20:45:14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Participant 2023-08-29 <span style="color: #949494;">00:00:14</span>     0 2023-08-29 <span style="color: #949494;">06:03:20</span> 2023-08-29 <span style="color: #949494;">20:45:14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Participant 2023-08-29 <span style="color: #949494;">00:00:24</span>     0 2023-08-29 <span style="color: #949494;">06:03:20</span> 2023-08-29 <span style="color: #949494;">20:45:14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Participant 2023-08-29 <span style="color: #949494;">00:00:34</span>     0 2023-08-29 <span style="color: #949494;">06:03:20</span> 2023-08-29 <span style="color: #949494;">20:45:14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Participant 2023-08-29 <span style="color: #949494;">00:00:44</span>     0 2023-08-29 <span style="color: #949494;">06:03:20</span> 2023-08-29 <span style="color: #949494;">20:45:14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> Participant 2023-08-29 <span style="color: #949494;">00:00:54</span>     0 2023-08-29 <span style="color: #949494;">06:03:20</span> 2023-08-29 <span style="color: #949494;">20:45:14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: photoperiod &lt;drtn&gt;, photoperiod.state &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">added_photoperiod</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="filter_Datetime.html">filter_Date</a></span><span class="op">(</span>length <span class="op">=</span> <span class="st">"3 days"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gg_days.html">gg_days</a></span><span class="op">(</span>aes_col <span class="op">=</span> <span class="va">photoperiod.state</span>,</span></span>
<span class="r-in"><span>          group <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/consecutive_id.html" class="external-link">consecutive_id</a></span><span class="op">(</span><span class="va">photoperiod.state</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          jco_color <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>          <span class="op">)</span></span></span>
<span class="r-plt img"><img src="photoperiod-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">added_photoperiod</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="filter_Datetime.html">filter_Date</a></span><span class="op">(</span>length <span class="op">=</span> <span class="st">"3 days"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gg_day.html">gg_day</a></span><span class="op">(</span>aes_col <span class="op">=</span> <span class="va">Id</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>dawn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dawn</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/hms.html" class="external-link">as_hms</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="va">dawn</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>dusk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dusk</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/hms.html" class="external-link">as_hms</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">dusk</span>, xmax <span class="op">=</span> <span class="fl">24</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="photoperiod-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">added_photoperiod</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>dawn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dawn</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/hms.html" class="external-link">as_hms</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Id          dawn           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;time&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Environment 18<span style="color: #949494;">:</span>07<span style="color: #949494;">:</span>04.984169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Participant 18<span style="color: #949494;">:</span>07<span style="color: #949494;">:</span>04.984169</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#solar_noon()</span></span></span>
<span class="r-in"><span> <span class="fu">solar_noon</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">dates</span>, <span class="va">tz</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         date            tz      lat      lon          solar.noon</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-06-01 Europe/Berlin 48.52164 9.057645 2023-06-01 13:21:35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2025-08-23 Europe/Berlin 48.52164 9.057645 2025-08-23 13:26:21</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Zauner, Manuel Spitschan, Steffen Hartmeyer, MeLiDos, EURAMET, European Union.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

