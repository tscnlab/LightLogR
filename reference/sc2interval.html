<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Statechange (sc) Timestamps to Intervals — sc2interval • LightLogR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statechange (sc) Timestamps to Intervals — sc2interval"><meta name="description" content='Takes an input of datetimes and Statechanges and creates a column with
Intervals. If full = TRUE, it will also create intervals for the day
prior to the first state change and after the last. If output.dataset = FALSE it will give a named vector, otherwise a tibble. The state change
info requires a description or name of the state (like "sleep" or "wake",
or "wear") that goes into effect at the given Datetime. Works for grouped
data so that it does not mix up intervals between participants. Missing data
should be explicit if at all possible. Also, the maximum allowed length of an
interval can be set, so that implicit missing timestamps after a set period
of times can be enforced.'><meta property="og:description" content='Takes an input of datetimes and Statechanges and creates a column with
Intervals. If full = TRUE, it will also create intervals for the day
prior to the first state change and after the last. If output.dataset = FALSE it will give a named vector, otherwise a tibble. The state change
info requires a description or name of the state (like "sleep" or "wake",
or "wear") that goes into effect at the given Datetime. Works for grouped
data so that it does not mix up intervals between participants. Missing data
should be explicit if at all possible. Also, the maximum allowed length of an
interval can be set, so that implicit missing timestamps after a set period
of times can be enforced.'><meta property="og:image" content="https://tscnlab.github.io/LightLogR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LightLogR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Day.html">The whole game</a></li>
    <li><a class="dropdown-item" href="../articles/Import.html">Import &amp; cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/Metrics.html">Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/photoperiod.html">Photoperiod</a></li>
    <li><a class="dropdown-item" href="../articles/Visualizations.html">Visualizations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tscnlab/LightLogR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Statechange (sc) Timestamps to Intervals</h1>
      <small class="dont-index">Source: <a href="https://github.com/tscnlab/LightLogR/blob/main/R/sc2interval.R" class="external-link"><code>R/sc2interval.R</code></a></small>
      <div class="d-none name"><code>sc2interval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes an input of <code>datetimes</code> and <code>Statechanges</code> and creates a column with
<code>Intervals</code>. If <code>full = TRUE</code>, it will also create intervals for the day
prior to the first state change and after the last. If <code>output.dataset = FALSE</code> it will give a named vector, otherwise a <code>tibble</code>. The <code>state change</code>
info requires a description or name of the state (like <code>"sleep"</code> or <code>"wake"</code>,
or <code>"wear"</code>) that goes into effect at the given <code>Datetime</code>. Works for grouped
data so that it does not mix up intervals between participants. Missing data
should be explicit if at all possible. Also, the maximum allowed length of an
interval can be set, so that implicit missing timestamps after a set period
of times can be enforced.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sc2interval</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  Datetime.colname <span class="op">=</span> <span class="va">Datetime</span>,</span>
<span>  Statechange.colname <span class="op">=</span> <span class="va">State</span>,</span>
<span>  State.colname <span class="op">=</span> <span class="va">State</span>,</span>
<span>  Interval.colname <span class="op">=</span> <span class="va">Interval</span>,</span>
<span>  full <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  starting.state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  output.dataset <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Datetime.keep <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  length.restriction <span class="op">=</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">24</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A light logger dataset. Expects a <code>dataframe</code>. If not imported
by <a href="LightLogR-package.html">LightLogR</a>, take care to choose a sensible variable for the
<code>Datetime.colname</code>.</p></dd>


<dt id="arg-datetime-colname">Datetime.colname<a class="anchor" aria-label="anchor" href="#arg-datetime-colname"></a></dt>
<dd><p>column name that contains the datetime. Defaults to
<code>"Datetime"</code> which is automatically correct for data imported with
<a href="LightLogR-package.html">LightLogR</a>. Expects a <code>symbol</code>. Needs to be part of the <code>dataset</code>. Must
be of type <code>POSIXct</code>.</p></dd>


<dt id="arg-statechange-colname-interval-colname-state-colname">Statechange.colname, Interval.colname, State.colname<a class="anchor" aria-label="anchor" href="#arg-statechange-colname-interval-colname-state-colname"></a></dt>
<dd><p>Column names that
do contain the name/description of the <code>state change</code> and that will contain
the <code>Interval</code> and <code>State</code> (which are also the default). Expects a <code>symbol</code>. The
<code>Statechange</code> column needs do be part of the <code>dataset</code>.</p></dd>


<dt id="arg-full-starting-state">full, starting.state<a class="anchor" aria-label="anchor" href="#arg-full-starting-state"></a></dt>
<dd><p>These arguments handle the state on the first day
before the first state change and after the last state change on the last
day. If <code>full = TRUE</code>(the default, expects a <code>logical</code>), it will create an
interval on the first day from 00:00:00 up until the state change. This
interval will be given the state specified in <code>starting.state</code>, which is <code>NA</code>
by default, but can be any <code>character</code> scalar. It will further extend the
interval for the last state change until the end of the last given day
(more specifically until 00:00:00 the next day).</p></dd>


<dt id="arg-output-dataset">output.dataset<a class="anchor" aria-label="anchor" href="#arg-output-dataset"></a></dt>
<dd><p>should the output be a <code>data.frame</code> (Default <code>TRUE</code>) or
a vector with <code>hms</code> (<code>FALSE</code>) times? Expects a <code>logical</code> scalar.</p></dd>


<dt id="arg-datetime-keep">Datetime.keep<a class="anchor" aria-label="anchor" href="#arg-datetime-keep"></a></dt>
<dd><p>If <code>TRUE</code>, the original <code>Datetime</code> column will be kept.</p></dd>


<dt id="arg-length-restriction">length.restriction<a class="anchor" aria-label="anchor" href="#arg-length-restriction"></a></dt>
<dd><p>If the length between intervals is too great, the
interval state can be set to <code>NA</code>, which effectively produces a gap in the
data. This makes sense when intervals are implausibly wrong (e.g. someone
slept for 50 hours), because when this data is combined with light logger
data, e.g., through <code><a href="interval2state.html">interval2state()</a></code>, metrics and visualizations will
remove the interval.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>One of</p><ul><li><p>a <code>data.frame</code> object identical to <code>dataset</code> but with the interval instead of the datetime. The original <code>Statechange</code> column now indicates the <code>State</code> during the <code>Interval</code>.</p></li>
<li><p>a named <code>vector</code> with the intervals, where the names are the states</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-08-15 6:00:00"</span>,</span></span>
<span class="r-in"><span>                                      <span class="st">"2023-08-15 23:00:00"</span>,</span></span>
<span class="r-in"><span>                                      <span class="st">"2023-08-16 6:00:00"</span>,</span></span>
<span class="r-in"><span>                                      <span class="st">"2023-08-16 22:00:00"</span>,</span></span>
<span class="r-in"><span>                                      <span class="st">"2023-08-17 6:30:00"</span>,</span></span>
<span class="r-in"><span>                                      <span class="st">"2023-08-18 1:00:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         State <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wake"</span>, <span class="st">"sleep"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         Id <span class="op">=</span> <span class="st">"Participant"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#intervals from sample</span></span></span>
<span class="r-in"><span><span class="fu">sc2interval</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   State Id          Interval                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;Interval&gt;</span>                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          2023-08-15 00:00:00 UTC--2023-08-15 06:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> wake  Participant 2023-08-15 06:00:00 UTC--2023-08-15 23:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> sleep Participant 2023-08-15 23:00:00 UTC--2023-08-16 06:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> wake  Participant 2023-08-16 06:00:00 UTC--2023-08-16 22:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> sleep Participant 2023-08-16 22:00:00 UTC--2023-08-17 06:30:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> wake  Participant 2023-08-17 06:30:00 UTC--2023-08-18 01:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> sleep Participant 2023-08-18 01:00:00 UTC--2023-08-19 00:00:00 UTC</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compare sample (y) and intervals (x)</span></span></span>
<span class="r-in"><span><span class="fu">sc2interval</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Datetime <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">int_start</a></span><span class="op">(</span><span class="va">Interval</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sample</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Id"</span>, <span class="st">"State"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   State Id          Interval                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;Interval&gt;</span>                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          2023-08-15 00:00:00 UTC--2023-08-15 06:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> wake  Participant 2023-08-15 06:00:00 UTC--2023-08-15 23:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> wake  Participant 2023-08-15 06:00:00 UTC--2023-08-15 23:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> wake  Participant 2023-08-15 06:00:00 UTC--2023-08-15 23:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> sleep Participant 2023-08-15 23:00:00 UTC--2023-08-16 06:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> sleep Participant 2023-08-15 23:00:00 UTC--2023-08-16 06:00:00 UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: Datetime.x &lt;dttm&gt;, Datetime.y &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Zauner, Manuel Spitschan, Steffen Hartmeyer, MeLiDos, EURAMET, European Union.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

